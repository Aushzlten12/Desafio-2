<div class="container mt-4">
  <h2 class="mb-3">{{ isEditing ? "Editar" : "Nueva" }} Persona</h2>

  <form
    (ngSubmit)="form.valid && save()"
    #form="ngForm"
    class="card p-4 shadow-sm"
    novalidate
  >
    <div class="mb-3">
      <label class="form-label">Nombre</label>
      <input
        type="text"
        class="form-control"
        [(ngModel)]="person.first_name"
        name="first_name"
        required
        minlength="1"
        maxlength="100"
        #fname="ngModel"
        [class.is-invalid]="fname.invalid && (fname.dirty || fname.touched)"
      />

      <div class="invalid-feedback" *ngIf="fname.errors?.['required']">
        El nombre es obligatorio.
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">Apellido</label>
      <input
        type="text"
        class="form-control"
        [(ngModel)]="person.last_name"
        name="last_name"
        required
        minlength="1"
        maxlength="100"
        #lname="ngModel"
        [class.is-invalid]="lname.invalid && (lname.dirty || lname.touched)"
      />

      <div class="invalid-feedback" *ngIf="lname.errors?.['required']">
        El apellido es obligatorio.
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">Email</label>
      <input
        type="email"
        class="form-control"
        [(ngModel)]="person.email"
        name="email"
        required
        email
        #emailRef="ngModel"
        [class.is-invalid]="
          emailRef.invalid && (emailRef.dirty || emailRef.touched)
        "
      />

      <div class="invalid-feedback" *ngIf="emailRef.errors?.['required']">
        El email es obligatorio.
      </div>
      <div class="invalid-feedback" *ngIf="emailRef.errors?.['email']">
        Formato de email inv√°lido.
      </div>
    </div>

    <div class="d-flex gap-2">
      <button
        type="submit"
        class="btn btn-success flex-grow-1"
        [disabled]="form.invalid"
      >
        Guardar
      </button>
      <a routerLink="/persons" class="btn btn-outline-secondary">Cancelar</a>
    </div>
  </form>
</div>
